{% extends "habits/base_index.html" %}

{% load app_filters %}

{% block main %}

<div id="wrapper">
  <!-- Sidebar -->
  {% if not user.is_anonymous %}
  <ul class="sidebar navbar-nav">
    <li class="nav-item">
      <span data-toggle="modal">
        <a id="new-habit-button" class="nav-link" data-target="#modal" data-form="{% url 'habit_new' %}" href="#" data-toggle="tooltip" data-placement="right" title="Add a habit">
          <i class="far fa-plus-square m-4"></i>
          Add Habit
        </a>
      </span>
    </li>
    {% for habit in habit_list %}
    <li class="nav-item">
      {% if habit.good_habit %}
      <a href="{% url 'habit_detail' habit.id %}" class="nav-link">
        <i class="far fa-circle"></i>
        <span>{{ habit.habit_name }}</span>
      </a>
      {% else %}
      <a href="{% url 'habit_detail' habit.id %}" class="nav-link">
        <i class="far fa-square"></i>
        <span>{{ habit.habit_name }}</span>
      </a>
      {% endif %}
      {% endfor %}
    </li>
  </ul>

  <div id="content-wrapper">
    <div class="container-fluid">
      <div class="modal fade" id="edit-modal"></div>

      <!-- Breadcrumbs-->
      <!-- <ol class="breadcrumb">
        <li class="breadcrumb-item">
          <a href="#">Dashboard</a>
        </li>
        <li class="breadcrumb-item active">Overview</li>
      </ol> -->

      <div class="container-fluid">
        {% for key, value in occurence.items %}
        <div class="{{ value|get_occurence:num_motives }}-circle">{{ key }}</div>
        {% endfor %}
      </div>

      <div class="container-fluid">
        <!-- Modal -->
        <div class="modal fade" id="edit-modal"></div>
        <!-- /.modal -->
        <span data-toggle="modal">
          <a data-form="{% url 'habit_delete' habit.pk %}" href="#" class="btn btn-outline-danger mr-2" style="float:right" role="button" data-toggle="tooltip" data-target="#modal" data-placement="bottom" id="delete-habit-button" title="Delete {{ habit }}">
            <i class="far fa-minus-square"></i>
          </a>
        </span>

        <span data-toggle="modal">
          <a id="edit-habit-button" data-form="{% url 'habit_edit' habit_id=habit_id %}" href="#" class="btn btn-outline-info mr-2" style="float:right" role="button" data-toggle="tooltip" data-target="#modal" data-placement="bottom" title="Edit {{ habit }}">
            <i class="fas fa-pencil-alt"></i>
          </a>
        </span>

        <span data-toggle="modal">
          <a id="new-action-button" data-form="{% url 'action_new' habit_id=habit_id %}" href="#" class="btn btn-outline-info mr-2" style="float:right" role="button" data-toggle="tooltip" data-target="#modal" data-placement="bottom" title="Add an action">
            <i class="far fa-plus-square"></i>
          </a>
        </span>

        <h2>{{ habit }}</h2>

        <table class="table">
          <tr>
            <th></th>
            <th>Actions</th>
            <th>Motives</th>
            <th>Date/Time</th>
          </tr>
          {% for action in action_list %}
          <tr>
            <td>
              <span data-toggle="modal">
                <a data-form="{% url 'action_edit' habit_id=habit.id pk=action.pk %}" href="#" class="edit-action-button btn btn-outline-info mr-2 btn-sm" role="button" data-toggle="tooltip" data-target="#modal" data-placement="bottom" title="Edit {{ action }}">
                  <i class="fas fa-pencil-alt"></i>
                </a>
              </span>
              <a href="{% url 'action_delete' pk=action.pk %}" class="btn btn-outline-danger mr-2 btn-sm" role="button" data-toggle="tooltip" data-placement="bottom" title="Delete {{ action }}">
                <i class="far fa-minus-square"></i>
              </a>
            </td>
            <td>
              {{ action }}<br/><br/>
            </td>
            <td>
              {% for t in action.motives.all %}
              {{ t }},
              {% endfor %}
            </td>
            <td>{{ action.action_time }}</td>
          </tr>
          {% endfor %}
        </table>

        <!-- Sticky Footer -->
        <footer class="sticky-footer">
          <div class="container my-auto">
            <div class="copyright text-center my-auto">
              <span>Copyright Â© ReconneQt 2018</span>
            </div>
          </div>
        </footer>
      </div>
    </div>
  </div>

  {% else %}
  <div id="content-wrapper">
    <div class="container-fluid">
      <p>Please login to see this page.</p>
    </div>
  </div>
  {% endif %}

  {% endblock %}
